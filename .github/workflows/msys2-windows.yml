name: msys2 Windows 10

on:
  push:
  pull_request:
  schedule:
    - cron: '0 0 * * 3'
  workflow_dispatch:

jobs:
    build:
      runs-on: windows-latest
      strategy:
        fail-fast: false
        matrix:
          include:
          - { sys: mingw64 }
      name: ${{ matrix.icon }} ${{ matrix.sys }}
      defaults:
        run:
          shell: msys2 {0}
      steps:
      - name: 'Checkout'
        uses: actions/checkout@v4
        with:
          fetch-depth: 0
      - name: '${{ matrix.icon }} Setup MSYS2'
        uses: msys2/setup-msys2@v2
        with:
          msystem: ${{matrix.sys}}
          update: true
          install: >-
            git
            python
            base-devel
            libxslt-devel
          pacboy: >-
            toolchain:p
            cmake:p
            make:p
            ninja:p
            gcc:p
            minizip:p
      # ----------------------------------------------------------
      - name: Download FPC 32-Bit / 64-Bit for Windows
        run: |
          mkdir -p   $(pwd)/fpc
          curl -L -o $(pwd)/fpc/fpc.tar.gz https://kallup.net/gitpack/fpc.tar.gz
          gzip    -d $(pwd)/fpc/fpc.tar.gz
          tar -xf    $(pwd)/fpc/fpc.tar -C $(pwd)/fpc
          dir $(pwd)
          D:\\a\\TinyRTL\\TinyRTL\\build.bat
      # ----------------------------------------------------------
      - name: 'Build TinyRTL for FPC'
        run: |
          echo "hallo"
